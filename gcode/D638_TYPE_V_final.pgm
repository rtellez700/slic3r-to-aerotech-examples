
DVAR $hFile
DVAR $cCheck
DVAR $press
DVAR $length
DVAR $lame
DVAR $comport
DVAR $vacpress

$DO0.0=0
$DO1.0=0
$DO2.0=0
$DO3.0=0

Primary ; sets primary units mm and s
G65 F250; DEFAULT ACCEL RATE
G65 F500; DEFAULT ACCEL RATE

Call setPress P5 Q50.0 ; tool 0

G90 ;use absolute coordinates 
MINUTES

; generated by Slic3r 1.3.0 on 2022-08-20 at 19:35:08

; external perimeters extrusion width = 0.25mm (0.34mm^3/s)
; perimeters extrusion width = 0.25mm (0.34mm^3/s)
; infill extrusion width = 0.25mm (0.05mm^3/s)
; solid infill extrusion width = 0.25mm (0.98mm^3/s)
; top infill extrusion width = 0.25mm (0.74mm^3/s)



 ; set units to millimeters
G90 ; use absolute coordinates

 ; reset extrusion distance
G92 X0 Y0  ; RESET X,Y HOME POSITION TO CURRENT POSITION
G1 Z0.250 F600.000 ; move to next layer (0)


 ; reset extrusion distance
G1 Z10.250 F600.000 ; lift Z
G1 X5.681 Y-1.527 F600.000 ; move to first infill point
G1 Z0.250 F600.000 ; restore layer Z

G1 F60
Call togglePress P5; toggle on

G1 X31.652 Y-1.527  ; infill
G1 X31.652 Y-1.745  ; infill
G1 X7.287 Y-1.745  ; infill
G1 X8.197 Y-1.963  ; infill
G1 X31.652 Y-1.963  ; infill
G1 X31.652 Y-2.182  ; infill
G1 X8.903 Y-2.182  ; infill
G1 X9.497 Y-2.400  ; infill
G1 X31.652 Y-2.400  ; infill
G1 X31.652 Y-2.618  ; infill
G1 X10.013 Y-2.618  ; infill
G1 X10.472 Y-2.836  ; infill
G1 X31.652 Y-2.836  ; infill
G1 X31.652 Y-3.054  ; infill
G1 X10.888 Y-3.054  ; infill
G1 X11.271 Y-3.272  ; infill
G1 X31.652 Y-3.272  ; infill
G1 X31.652 Y-3.491  ; infill
G1 X11.628 Y-3.491  ; infill
G1 X11.963 Y-3.709  ; infill
G1 X31.652 Y-3.709  ; infill
G1 X31.652 Y-3.927  ; infill
G1 X12.271 Y-3.927  ; infill
G1 X12.563 Y-4.145  ; infill
G1 X31.652 Y-4.145  ; infill
G1 X31.652 Y-4.363  ; infill
G1 X12.842 Y-4.363  ; infill
G1 X13.100 Y-4.581  ; infill
G1 X31.652 Y-4.581  ; infill

Call togglePress P5; toggle off
 ; reset extrusion distance

G1 Z10.250 F600.000 ; lift Z
G1 X13.1000 Y4.5810 F600.000 ; move to first infill point
G1 Z0.250 F600.000 ; restore layer Z

G1 F60
Call togglePress P5; toggle on


G1 X31.6520 Y4.5810 ; infill
G1 X31.6520 Y4.3630 ; infill
G1 X12.8420 Y4.3630 ; infill
G1 X12.5630 Y4.1450 ; infill
G1 X31.6520 Y4.1450 ; infill
G1 X31.6520 Y3.9270 ; infill
G1 X12.2710 Y3.9270 ; infill
G1 X11.9630 Y3.7090 ; infill
G1 X31.6520 Y3.7090 ; infill
G1 X31.6520 Y3.4910 ; infill
G1 X11.6280 Y3.4910 ; infill
G1 X11.2710 Y3.2720 ; infill
G1 X31.6520 Y3.2720 ; infill
G1 X31.6520 Y3.0540 ; infill
G1 X10.8880 Y3.0540 ; infill
G1 X10.4720 Y2.8360 ; infill
G1 X31.6520 Y2.8360 ; infill
G1 X31.6520 Y2.6180 ; infill
G1 X10.0130 Y2.6180 ; infill
G1 X9.4970 Y2.4000 ; infill
G1 X31.6520 Y2.4000 ; infill
G1 X31.6520 Y2.1820 ; infill
G1 X8.9030 Y2.1820 ; infill
G1 X8.1970 Y1.9630 ; infill
G1 X31.6520 Y1.9630 ; infill
G1 X31.6520 Y1.7450 ; infill
G1 X7.2870 Y1.7450 ; infill
G1 X6.3930 Y1.5960 ; infill
G1 X5.6810 Y1.5270 ; infill
G1 X31.6520 Y1.5270 ; infill
G1 X31.6520 Y1.3090 ; infill


G1 X-31.652 Y1.309  ; infill

G1 X-31.652 Y1.091  ; infill

G1 X31.6520 Y1.0910 ; infill
G1 X31.6520 Y0.8730 ; infill


G1 X-31.652 Y0.873  ; infill

G1 X-31.652 Y0.654  ; infill

G1 X31.6520 Y0.6540 ; infill
G1 X31.6520 Y0.4360 ; infill


G1 X-31.652 Y0.436  ; infill

G1 X-31.652 Y0.218  ; infill

G1 X31.6520 Y0.2180 ; infill
G1 X31.6520 Y0.0000 ; infill


G1 X-31.652 Y-0.000  ; infill

G1 X-31.652 Y-0.218  ; infill
G1 X31.652 Y-0.218  ; infill
G1 X31.652 Y-0.436  ; infill
G1 X-31.652 Y-0.436  ; infill
G1 X-31.652 Y-0.654  ; infill
G1 X31.652 Y-0.654  ; infill
G1 X31.652 Y-0.873  ; infill
G1 X-31.652 Y-0.873  ; infill
G1 X-31.652 Y-1.091  ; infill
G1 X31.652 Y-1.091  ; infill
G1 X31.652 Y-1.309  ; infill
G1 X-31.652 Y-1.309  ; infill
G1 X-31.652 Y-1.527  ; infill
G1 X-5.681 Y-1.527  ; infill
G1 X-6.393 Y-1.596  ; infill
G1 X-7.287 Y-1.745  ; infill
G1 X-31.652 Y-1.745  ; infill
G1 X-31.652 Y-1.963  ; infill
G1 X-8.197 Y-1.963  ; infill
G1 X-8.903 Y-2.182  ; infill
G1 X-31.652 Y-2.182  ; infill
G1 X-31.652 Y-2.400  ; infill
G1 X-9.497 Y-2.400  ; infill
G1 X-10.013 Y-2.618  ; infill
G1 X-31.652 Y-2.618  ; infill
G1 X-31.652 Y-2.836  ; infill
G1 X-10.472 Y-2.836  ; infill
G1 X-10.888 Y-3.054  ; infill
G1 X-31.652 Y-3.054  ; infill
G1 X-31.652 Y-3.272  ; infill
G1 X-11.271 Y-3.272  ; infill
G1 X-11.628 Y-3.491  ; infill
G1 X-31.652 Y-3.491  ; infill
G1 X-31.652 Y-3.709  ; infill
G1 X-11.963 Y-3.709  ; infill
G1 X-12.271 Y-3.927  ; infill
G1 X-31.652 Y-3.927  ; infill
G1 X-31.652 Y-4.145  ; infill
G1 X-12.563 Y-4.145  ; infill
G1 X-12.842 Y-4.363  ; infill
G1 X-31.652 Y-4.363  ; infill
G1 X-31.652 Y-4.581  ; infill
G1 X-13.100 Y-4.581  ; infill

Call togglePress P5; toggle off
 ; reset extrusion distance

G1 Z10.250 F600.000 ; lift Z
G1 X-5.681 Y1.527 F600.000 ; move to first infill point
G1 Z0.250 F600.000 ; restore layer Z

G1 F60
Call togglePress P5; toggle on

G1 X-31.652 Y1.527  ; infill
G1 X-31.652 Y1.745  ; infill
G1 X-7.287 Y1.745  ; infill
G1 X-8.197 Y1.963  ; infill
G1 X-31.652 Y1.963  ; infill
G1 X-31.652 Y2.182  ; infill
G1 X-8.903 Y2.182  ; infill
G1 X-9.497 Y2.400  ; infill
G1 X-31.652 Y2.400  ; infill
G1 X-31.652 Y2.618  ; infill
G1 X-10.013 Y2.618  ; infill
G1 X-10.472 Y2.836  ; infill
G1 X-31.652 Y2.836  ; infill
G1 X-31.652 Y3.054  ; infill
G1 X-10.888 Y3.054  ; infill
G1 X-11.271 Y3.272  ; infill
G1 X-31.652 Y3.272  ; infill
G1 X-31.652 Y3.491  ; infill
G1 X-11.628 Y3.491  ; infill
G1 X-11.963 Y3.709  ; infill
G1 X-31.652 Y3.709  ; infill
G1 X-31.652 Y3.927  ; infill
G1 X-12.271 Y3.927  ; infill
G1 X-12.563 Y4.145  ; infill
G1 X-31.652 Y4.145  ; infill
G1 X-31.652 Y4.363  ; infill
G1 X-12.842 Y4.363  ; infill
G1 X-13.100 Y4.581  ; infill
G1 X-31.652 Y4.581  ; infill
Call togglePress P5; toggle off
G1 Z0.500 F600.000 ; move to next layer (1)

G1 F60
Call togglePress P5; toggle on

G1 X-13.100 Y4.581  ; infill
G1 X-12.842 Y4.363  ; infill
G1 X-31.652 Y4.363  ; infill
G1 X-31.652 Y4.145  ; infill
G1 X-12.563 Y4.145  ; infill
G1 X-12.271 Y3.927  ; infill
G1 X-31.652 Y3.927  ; infill
G1 X-31.652 Y3.709  ; infill
G1 X-11.963 Y3.709  ; infill
G1 X-11.628 Y3.491  ; infill
G1 X-31.652 Y3.491  ; infill
G1 X-31.652 Y3.272  ; infill
G1 X-11.271 Y3.272  ; infill
G1 X-10.888 Y3.054  ; infill
G1 X-31.652 Y3.054  ; infill
G1 X-31.652 Y2.836  ; infill
G1 X-10.472 Y2.836  ; infill
G1 X-10.013 Y2.618  ; infill
G1 X-31.652 Y2.618  ; infill
G1 X-31.652 Y2.400  ; infill
G1 X-9.497 Y2.400  ; infill
G1 X-8.903 Y2.182  ; infill
G1 X-31.652 Y2.182  ; infill
G1 X-31.652 Y1.963  ; infill
G1 X-8.197 Y1.963  ; infill
G1 X-7.287 Y1.745  ; infill
G1 X-31.652 Y1.745  ; infill
G1 X-31.652 Y1.527  ; infill
G1 X-5.681 Y1.527  ; infill

Call togglePress P5; toggle off
 ; reset extrusion distance

G1 Z10.500 F600.000 ; lift Z
G1 X-13.100 Y-4.581 F600.000 ; move to first infill point
G1 Z0.500 F600.000 ; restore layer Z

G1 F60
Call togglePress P5; toggle on

G1 X-31.652 Y-4.581  ; infill
G1 X-31.652 Y-4.363  ; infill
G1 X-12.842 Y-4.363  ; infill
G1 X-12.563 Y-4.145  ; infill
G1 X-31.652 Y-4.145  ; infill
G1 X-31.652 Y-3.927  ; infill
G1 X-12.271 Y-3.927  ; infill
G1 X-11.963 Y-3.709  ; infill
G1 X-31.652 Y-3.709  ; infill
G1 X-31.652 Y-3.491  ; infill
G1 X-11.628 Y-3.491  ; infill
G1 X-11.271 Y-3.272  ; infill
G1 X-31.652 Y-3.272  ; infill
G1 X-31.652 Y-3.054  ; infill
G1 X-10.888 Y-3.054  ; infill
G1 X-10.472 Y-2.836  ; infill
G1 X-31.652 Y-2.836  ; infill
G1 X-31.652 Y-2.618  ; infill
G1 X-10.013 Y-2.618  ; infill
G1 X-9.497 Y-2.400  ; infill
G1 X-31.652 Y-2.400  ; infill
G1 X-31.652 Y-2.182  ; infill
G1 X-8.903 Y-2.182  ; infill
G1 X-8.197 Y-1.963  ; infill
G1 X-31.652 Y-1.963  ; infill
G1 X-31.652 Y-1.745  ; infill
G1 X-7.287 Y-1.745  ; infill
G1 X-6.393 Y-1.596  ; infill
G1 X-5.681 Y-1.527  ; infill
G1 X-31.652 Y-1.527  ; infill
G1 X-31.652 Y-1.309  ; infill
G1 X31.652 Y-1.309  ; infill
G1 X31.652 Y-1.091  ; infill
G1 X-31.652 Y-1.091  ; infill
G1 X-31.652 Y-0.873  ; infill
G1 X31.652 Y-0.873  ; infill
G1 X31.652 Y-0.654  ; infill
G1 X-31.652 Y-0.654  ; infill
G1 X-31.652 Y-0.436  ; infill
G1 X31.652 Y-0.436  ; infill
G1 X31.652 Y-0.218  ; infill
G1 X-31.652 Y-0.218  ; infill
G1 X-31.652 Y-0.000  ; infill

G1 X31.6520 Y0.0000 ; infill
G1 X31.6520 Y0.2180 ; infill


G1 X-31.652 Y0.218  ; infill

G1 X-31.652 Y0.436  ; infill

G1 X31.6520 Y0.4360 ; infill
G1 X31.6520 Y0.6540 ; infill


G1 X-31.652 Y0.654  ; infill

G1 X-31.652 Y0.873  ; infill

G1 X31.6520 Y0.8730 ; infill
G1 X31.6520 Y1.0910 ; infill


G1 X-31.652 Y1.091  ; infill

G1 X-31.652 Y1.309  ; infill

G1 X31.6520 Y1.3090 ; infill
G1 X31.6520 Y1.5270 ; infill
G1 X5.6810 Y1.5270 ; infill
G1 X6.3930 Y1.5960 ; infill
G1 X7.2870 Y1.7450 ; infill
G1 X31.6520 Y1.7450 ; infill
G1 X31.6520 Y1.9630 ; infill
G1 X8.1970 Y1.9630 ; infill
G1 X8.9030 Y2.1820 ; infill
G1 X31.6520 Y2.1820 ; infill
G1 X31.6520 Y2.4000 ; infill
G1 X9.4970 Y2.4000 ; infill
G1 X10.0130 Y2.6180 ; infill
G1 X31.6520 Y2.6180 ; infill
G1 X31.6520 Y2.8360 ; infill
G1 X10.4720 Y2.8360 ; infill
G1 X10.8880 Y3.0540 ; infill
G1 X31.6520 Y3.0540 ; infill
G1 X31.6520 Y3.2720 ; infill
G1 X11.2710 Y3.2720 ; infill
G1 X11.6280 Y3.4910 ; infill
G1 X31.6520 Y3.4910 ; infill
G1 X31.6520 Y3.7090 ; infill
G1 X11.9630 Y3.7090 ; infill
G1 X12.2710 Y3.9270 ; infill
G1 X31.6520 Y3.9270 ; infill
G1 X31.6520 Y4.1450 ; infill
G1 X12.5630 Y4.1450 ; infill
G1 X12.8420 Y4.3630 ; infill
G1 X31.6520 Y4.3630 ; infill
G1 X31.6520 Y4.5810 ; infill
G1 X13.1000 Y4.5810 ; infill




Call togglePress P5; toggle off
 ; reset extrusion distance

G1 Z10.500 F600.000 ; lift Z
G1 X5.681 Y-1.527 F600.000 ; move to first infill point
G1 Z0.500 F600.000 ; restore layer Z

G1 F60
Call togglePress P5; toggle on

G1 X31.652 Y-1.527  ; infill
G1 X31.652 Y-1.745  ; infill
G1 X7.287 Y-1.745  ; infill
G1 X8.197 Y-1.963  ; infill
G1 X31.652 Y-1.963  ; infill
G1 X31.652 Y-2.182  ; infill
G1 X8.903 Y-2.182  ; infill
G1 X9.497 Y-2.400  ; infill
G1 X31.652 Y-2.400  ; infill
G1 X31.652 Y-2.618  ; infill
G1 X10.013 Y-2.618  ; infill
G1 X10.472 Y-2.836  ; infill
G1 X31.652 Y-2.836  ; infill
G1 X31.652 Y-3.054  ; infill
G1 X10.888 Y-3.054  ; infill
G1 X11.271 Y-3.272  ; infill
G1 X31.652 Y-3.272  ; infill
G1 X31.652 Y-3.491  ; infill
G1 X11.628 Y-3.491  ; infill
G1 X11.963 Y-3.709  ; infill
G1 X31.652 Y-3.709  ; infill
G1 X31.652 Y-3.927  ; infill
G1 X12.271 Y-3.927  ; infill
G1 X12.563 Y-4.145  ; infill
G1 X31.652 Y-4.145  ; infill
G1 X31.652 Y-4.363  ; infill
G1 X12.842 Y-4.363  ; infill
G1 X13.100 Y-4.581  ; infill
G1 X31.652 Y-4.581  ; infill

Call togglePress P5; toggle off
 ; reset extrusion distance

G1 Z10.500 F600.000 ; lift Z



; filament used = 10.6mm (0.2cm3)
; total filament cost = 0.0

; avoid_crossing_perimeters = 0
; bed_shape = -175x-175,175x-175,175x175,-175x175
; bed_temperature = 0
; before_layer_gcode = 
; between_objects_gcode = 
; bridge_acceleration = 0
; bridge_fan_speed = 100
; brim_connections_width = 0
; brim_width = 0
; complete_objects = 0
; cooling = 0
; default_acceleration = 0
; disable_fan_first_layers = 3
; duplicate_distance = 6
; end_filament_gcode = ""
; end_gcode = 
; extruder_clearance_height = 20
; extruder_clearance_radius = 20
; extruder_offset = 0x0
; extrusion_axis = E
; extrusion_multiplier = 1
; fan_always_on = 0
; fan_below_layer_time = 60
; filament_colour = #00FF00
; filament_cost = 0
; filament_density = 0
; filament_diameter = 5
; filament_max_volumetric_speed = 0
; filament_notes = ""
; first_layer_acceleration = 0
; first_layer_bed_temperature = 0
; first_layer_extrusion_width = 0.25
; first_layer_speed = 1
; first_layer_temperature = 0
; gcode_arcs = 0
; gcode_comments = 1
; gcode_flavor = reprap
; has_heatbed = 0
; infill_acceleration = 0
; infill_first = 0
; interior_brim_width = 0
; layer_gcode = 
; max_fan_speed = 100
; max_layer_height = 0.3
; max_print_speed = 80
; max_volumetric_speed = 0
; min_fan_speed = 35
; min_layer_height = 0.15
; min_print_speed = 10
; min_skirt_length = 0
; notes = 
; nozzle_diameter = 0.25
; only_retract_when_crossing_perimeters = 0
; ooze_prevention = 0
; output_filename_format = [input_filename_base].gcode
; perimeter_acceleration = 0
; post_process = 
; pressure_advance = 0
; printer_notes = 
; resolution = 0
; retract_before_travel = 2
; retract_layer_change = 0
; retract_length = 2
; retract_length_toolchange = 10
; retract_lift = 10
; retract_lift_above = 0
; retract_lift_below = 0
; retract_restart_extra = 0
; retract_restart_extra_toolchange = 0
; retract_speed = 40
; skirt_distance = 0
; skirt_height = 1
; skirts = 0
; slowdown_below_layer_time = 5
; spiral_vase = 0
; standby_temperature_delta = -5
; start_filament_gcode = ""
; start_gcode = 
; temperature = 0
; threads = 12
; toolchange_gcode = 
; travel_speed = 10
; use_firmware_retraction = 0
; use_relative_e_distances = 0
; use_set_and_wait_bed = 0
; use_set_and_wait_extruder = 0
; use_volumetric_e = 0
; vibration_limit = 0
; wipe = 0
; z_offset = 0
; z_steps_per_mm = 0
; adaptive_slicing = 0
; adaptive_slicing_quality = 75%
; dont_support_bridges = 1
; extrusion_width = 0.25
; first_layer_height = 0.25
; infill_only_where_needed = 0
; interface_shells = 0
; layer_height = 0.25
; match_horizontal_surfaces = 0
; raft_layers = 0
; regions_overlap = 0
; seam_position = aligned
; sequential_print_priority = 0
; support_material = 0
; support_material_angle = 0
; support_material_buildplate_only = 0
; support_material_contact_distance = 0.2
; support_material_enforce_layers = 0
; support_material_extruder = 1
; support_material_extrusion_width = 0
; support_material_interface_extruder = 1
; support_material_interface_extrusion_width = 0
; support_material_interface_layers = 3
; support_material_interface_spacing = 0
; support_material_interface_speed = 100%
; support_material_max_layers = 0
; support_material_pattern = pillars
; support_material_spacing = 2.5
; support_material_speed = 77
; support_material_threshold = 60%
; xy_size_compensation = 0
; bottom_infill_pattern = rectilinear
; bottom_solid_layers = 0
; bridge_flow_ratio = 1
; bridge_speed = 0
; external_perimeter_extrusion_width = 0
; external_perimeter_speed = 7
; external_perimeters_first = 0
; extra_perimeters = 0
; fill_angle = 0
; fill_density = 90%
; fill_gaps = 0
; fill_pattern = alignedrectilinear
; gap_fill_speed = 20
; infill_every_layers = 1
; infill_extruder = 1
; infill_extrusion_width = 0.25
; infill_overlap = 0
; infill_speed = 1
; overhangs = 0
; perimeter_extruder = 1
; perimeter_extrusion_width = 0
; perimeter_speed = 7
; perimeters = 0
; small_perimeter_speed = 7
; solid_infill_below_area = 0
; solid_infill_every_layers = 0
; solid_infill_extruder = 1
; solid_infill_extrusion_width = 0
; solid_infill_speed = 20
; thin_walls = 0
; top_infill_extrusion_width = 0
; top_infill_pattern = rectilinear
; top_solid_infill_speed = 15
; top_solid_layers = 0
SECONDS

;#################################### Code ##########################################

M2

;##########Nordson Pressure Box Functions############;
DFS setPress        
         
        $strtask1 = DBLTOSTR( $P, 0 )            
        $strtask1 = "COM" + $strtask1
        $hFile = FILEOPEN $strtask1, 2
        COMMINIT $hFile, "baud=115200 parity=N data=8 stop=1"
        COMMSETTIMEOUT $hFile, -1, -1, 1000
                             
        $press = $Q * 10.0                             
        $strtask2 = DBLTOSTR( $press , 0 )  
      
      
        $length = STRLEN( $strtask2 )      
        WHILE $length < 4.0
                $strtask2 = "0" + $strtask2    
                $length = STRLEN( $strtask2 ) 
        ENDWHILE


        $strtask2 = "08PS  " + $strtask2
                                    
        $cCheck = 0.00     
        $lame = STRTOASCII ($strtask2, 0)
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 1) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 2) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 3) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 4)
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 5) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 6) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 7) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 8) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 9)  
        $cCheck = $cCheck - $lame
                        
        WHILE( $cCheck) < 0
                $cCheck = $cCheck + 256
        ENDWHILE                        


        $strtask3 = makestring "{#H}" $cCheck   
        $strtask3 = STRUPR( $strtask3 )
        $strtask2 = "" + $strtask2 + $strtask3 + ""
            
        FILEWRITE $hFile ""
        FILEWRITE $hFile $strtask2
        FILEWRITE $hFile ""


        FILECLOSE $hFile


ENDDFS

DFS setVac      
         
        $strtask1 = DBLTOSTR( $P, 0 )            
        $strtask1 = "COM" + $strtask1
        $hFile = FILEOPEN $strtask1, 2
        COMMINIT $hFile, "baud=115200 parity=N data=8 stop=1"
        COMMSETTIMEOUT $hFile, -1, -1, 1000
                             
        $vacpress = $Q * 10.0                             
        $strtask2 = DBLTOSTR( $vacpress , 0 )  
      
      
        $length = STRLEN( $strtask2 )      
        WHILE $length < 4.0
                $strtask2 = "0" + $strtask2    
                $length = STRLEN( $strtask2 ) 
        ENDWHILE


        $strtask2 = "08VS  " + $strtask2
                                    
        $cCheck = 0.00     
        $lame = STRTOASCII ($strtask2, 0)
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 1) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 2) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 3) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 4)
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 5) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 6) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 7) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 8) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 9)  
        $cCheck = $cCheck - $lame
                        
        WHILE( $cCheck) < 0
                $cCheck = $cCheck + 256
        ENDWHILE                        


        $strtask3 = makestring "{#H}" $cCheck   
        $strtask3 = STRUPR( $strtask3 )
        $strtask2 = "" + $strtask2 + $strtask3 + ""
            
        FILEWRITE $hFile ""
        FILEWRITE $hFile $strtask2
        FILEWRITE $hFile ""


        FILECLOSE $hFile


ENDDFS

DFS togglePress        
         
        $strtask1 = DBLTOSTR( $P, 0 )            
        $strtask1 = "COM" + $strtask1
        $hFile = FILEOPEN $strtask1, 2
        COMMINIT $hFile, "baud=115200 parity=N data=8 stop=1"
        COMMSETTIMEOUT $hFile, -1, -1, 1000


        $strtask2 = "04DI  "
                                    
        $cCheck = 0.00     
        $lame = STRTOASCII ($strtask2, 0)
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 1) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 2) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 3) 
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 4)
        $cCheck = $cCheck - $lame
        $lame = STRTOASCII( $strtask2, 5) 
        $cCheck = $cCheck - $lame
                        
        WHILE( $cCheck) < 0
                $cCheck = $cCheck + 256
        ENDWHILE                        


        $strtask3 = makestring "{#H}" $cCheck   
        $strtask3 = STRUPR( $strtask3 )
        $strtask2 = "" + $strtask2 + $strtask3 + ""
                  
        FILEWRITE $hFile ""
        FILEWRITE $hFile $strtask2
        FILEWRITE $hFile ""


        FILECLOSE $hFile
        G4 P0.15

ENDDFS

;##########Omnicure Functions############;
DFS omniOn

        $strtask1 = DBLTOSTR( $P, 0 )
        $strtask1 = "COM" + $strtask1
        $hFile = FILEOPEN $strtask1, 2
        COMMINIT $hFile, "baud=19200 parity=N data=8 stop=1"
        COMMSETTIMEOUT $hFile, -1, -1, 1000
                
        FILEWRITENOTERM $hFile "CONN18
"
        FILEREAD $hFile, 0, $strtask2
        WHILE STRCMP($strtask2,"READY0A",0)
                FILEWRITENOTERM $hFile "CONN18
"
                FILEREAD $hFile, 0, $strtask2
        ENDWHILE
        
        FILEWRITENOTERM $hFile "OPN40
"
        FILEREAD $hFile, 0, $strtask2
        WHILE STRCMP($strtask2,"ReceivedBF",0)
                FILEWRITENOTERM $hFile "OPN40
"
                FILEREAD $hFile, 0, $strtask2
        ENDWHILE
        
        FILEWRITENOTERM $hFile "DCONE1
"
        FILEREAD $hFile, 0, $strtask2
        WHILE STRCMP($strtask2,"CLOSED42",0)
                FILEWRITENOTERM $hFile "DCONE1
"
                FILEREAD $hFile, 0, $strtask2
        ENDWHILE
        FILECLOSE $hFile

ENDDFS

DFS omniOff

        $strtask1 = DBLTOSTR( $P, 0 )
        $strtask1 = "COM" + $strtask1
        $hFile = FILEOPEN $strtask1, 2
        COMMINIT $hFile, "baud=19200 parity=N data=8 stop=1"
        COMMSETTIMEOUT $hFile, -1, -1, 1000
                
        FILEWRITENOTERM $hFile "CONN18
"
        FILEREAD $hFile, 0, $strtask2
        WHILE STRCMP($strtask2,"READY0A",0)
                FILEWRITENOTERM $hFile "CONN18
"
                FILEREAD $hFile, 0, $strtask2
        ENDWHILE
        
        FILEWRITENOTERM $hFile "CLS3A
"
        FILEREAD $hFile, 0, $strtask2
        WHILE STRCMP($strtask2,"ReceivedBF",0)
                FILEWRITENOTERM $hFile "CLS3A
"
                FILEREAD $hFile, 0, $strtask2
        ENDWHILE
        
        FILEWRITENOTERM $hFile "DCONE1
"
        FILEREAD $hFile, 0, $strtask2
        WHILE STRCMP($strtask2,"CLOSED42",0)
                FILEWRITENOTERM $hFile "DCONE1
"
                FILEREAD $hFile, 0, $strtask2
        ENDWHILE
        FILECLOSE $hFile
        
ENDDFS

DFS omniSetInt

        $strtask1 = DBLTOSTR( $P, 0 )
        $strtask1 = "COM" + $strtask1
        $hFile = FILEOPEN $strtask1, 2
        COMMINIT $hFile, "baud=19200 parity=N data=8 stop=1"
        COMMSETTIMEOUT $hFile, -1, -1, 1000

        FILEWRITENOTERM $hFile "CONN18
"
        FILEREAD $hFile, 0, $strtask2
        WHILE STRCMP($strtask2,"READY0A",0)
                FILEWRITENOTERM $hFile "CONN18
"
                FILEREAD $hFile, 0, $strtask2
        ENDWHILE

        $strtask4 = $strtask4 + "
"
        FILEWRITENOTERM $hFile $strtask4
        FILEREAD $hFile, 0, $strtask2
        WHILE STRCMP($strtask2,"ReceivedBF",0)
                FILEWRITENOTERM $hFile $strtask4
                FILEREAD $hFile, 0, $strtask2
        ENDWHILE

        FILEWRITENOTERM $hFile "DCONE1
"
        FILEREAD $hFile, 0, $strtask2
        WHILE STRCMP($strtask2,"CLOSED42",0)
                FILEWRITENOTERM $hFile "DCONE1
"
                FILEREAD $hFile, 0, $strtask2
        ENDWHILE
        FILECLOSE $hFile

ENDDFS

;##########Alicat Functions############;
DFS setAlicatPress

        $strtask1 = DBLTOSTR( $P, 0 )
        $strtask1 = "COM" + $strtask1
        $hFile = FILEOPEN $strtask1, 2
        COMMINIT $hFile, "baud=19200 parity=N data=8 stop=1"
        COMMSETTIMEOUT $hFile, -1, -1, 1000
                
        $strtask2 = DBLTOSTR($Q,2)
        $strtask3 = "AS" + $strtask2 + "
"
        FILEWRITENOTERM $hFile $strtask3
        FILECLOSE $hFile

ENDDFS
